using Content.Shared.Humanoid;
using Content.Shared.Humanoid.Markings;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Humanoid;

// hack for a panel that modifies an entity's markings on demand

[GenerateTypedNameReferences]
public sealed partial class HumanoidMarkingModifierWindow : DefaultWindow
{
    public Action<MarkingSet>? OnMarkingAdded;
    public Action<MarkingSet>? OnMarkingRemoved;
    public Action<MarkingSet>? OnMarkingColorChange;
    public Action<MarkingSet>? OnMarkingRankChange;

    public HumanoidMarkingModifierWindow()
    {
        RobustXamlLoader.Load(this);

        MarkingPickerWidget.OnMarkingAdded += (set, _) => OnMarkingAdded!(set); // WD EDIT
        MarkingPickerWidget.OnMarkingRemoved += (set, _) => OnMarkingRemoved!(set); // WD EDIT
        MarkingPickerWidget.OnMarkingColorChange += (set, _) => OnMarkingColorChange!(set); // WD EDIT
        MarkingPickerWidget.OnMarkingRankChange += set => OnMarkingRankChange!(set);
        MarkingForced.OnToggled += args => MarkingPickerWidget.Forced = args.Pressed;
        MarkingIgnoreSpecies.OnToggled += args => MarkingPickerWidget.Forced = args.Pressed;

        MarkingPickerWidget.Forced = MarkingForced.Pressed;
        MarkingPickerWidget.IgnoreSpecies = MarkingForced.Pressed;
    }

    public void SetState(
        MarkingSet markings,
        string species,
        Sex sex,
        Color skinColor,
        Color eyeColor // WD EDIT
    )
    {
        MarkingPickerWidget.SetData(markings, species, sex, skinColor, eyeColor);
    }
}
